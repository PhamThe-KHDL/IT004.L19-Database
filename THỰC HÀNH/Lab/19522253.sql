--HỌ VÀ TÊN : PHẠM ĐỨC THỂ
--MSSV : 19522253 

--TUAN 01--

---BAI TAP 01---
-- CAU I.1
CREATE DATABASE QuanLyBanHang
GO 
USE QuanLyBanHang

SET DATEFORMAT DMY

--TAO BANG KHACH HANG

CREATE TABLE KHACHHANG
(
	MAKH char(4) NOT NULL,
	HOTEN varchar(40),
	DCHI varchar(50),
	SODT varchar(20),
	NGSINH smalldatetime,
	NGDK smalldatetime,
	DOANHSO money
)

--TAO BANG NHANVIEN
CREATE TABLE NHANVIEN
(
	MANV char(4) NOT NULL,
	HOTEN varchar(40),
	SODT varchar(20),
	NGVL smalldatetime
)

--TAO BANG SANPHAM
CREATE TABLE SANPHAM
(
	MASP char(4) NOT NULL,
	TENSP varchar(40),
	DVT varchar(20),
	NUOCSX varchar(40),
	GIA money
)

--TAO BANG HOADON
CREATE TABLE HOADON
(
	SOHD int NOT NULL,
	NGHD smalldatetime,
	MAKH char(4),
	MANV char(4),
	GIATRI money
)

--TAO BANG CTHD

CREATE TABLE CTHD
(
	SOHD int NOT NULL,
	MASP char(4) NOT NULL,
	SL int
)

--TAO KHOA CHINH

ALTER TABLE KHACHHANG ADD
CONSTRAINT PK_KH PRIMARY KEY (MAKH)

ALTER TABLE NHANVIEN ADD
CONSTRAINT PK_NV PRIMARY KEY (MANV)

ALTER TABLE SANPHAM ADD
CONSTRAINT PK_PS PRIMARY KEY (MASP)

ALTER TABLE HOADON ADD
CONSTRAINT PK_HD PRIMARY KEY (SOHD)

ALTER TABLE CTHD ADD
CONSTRAINT PK_CTHD PRIMARY KEY (SOHD,MASP)

--TAO KHOA NGOAI

ALTER TABLE HOADON ADD
CONSTRAINT FK_HD_KH FOREIGN KEY (MAKH) REFERENCES KHACHHANG(MAKH),
CONSTRAINT FK_HD_NV FOREIGN KEY (MANV) REFERENCES NHANVIEN(MANV)

ALTER TABLE CTHD ADD
CONSTRAINT FK_CTHD_SHD FOREIGN KEY (SOHD) REFERENCES HOADON(SOHD),
CONSTRAINT FK_CTHD_MSP FOREIGN KEY (MASP) REFERENCES SANPHAM(MASP)

--XOA BANG 

DROP TABLE KHACHHANG
DROP TABLE HOADON
DROP TABLE CTHD
DROP TABLE NHANVIEN
DROP TABLE SANPHAM

--THEM THUOC TINH VAO BANG

--CAU I.2 THEM THUOC TINH 
ALTER TABLE SANPHAM ADD
	GHICHU varchar(20)

--CAU I.3 THEM THUOC TINH
ALTER TABLE KHACHHANG ADD
	LOAIKH tinyint 

--CAU I.4 SUA KIEU DU LIEU CUA THUOC TINH
ALTER TABLE SANPHAM 
ALTER COLUMN GHICHU varchar(100) 

--CAU I.5 XOA THUOC THUOC TINH
--XOA COLUMN TRONG TABLE
ALTER TABLE SANPHAM 
DROP COLUMN GHICHU 

--CAU I.6 CACH GIAI QUYET -> THAY DOI KIEU DU LIEU
ALTER TABLE KHACHHANG
ALTER COLUMN LOAIKH varchar(20)

--CAU I.7+I.8 DUNG RANG BUOC CHECK CHO THUOC TINH DVT
ALTER TABLE SANPHAM ADD
CONSTRAINT CK_DVT CHECK (DVT IN('cay','hop','cai','quyen','chuc')),
CONSTRAINT CK_GIA CHECK (GIA >= 500)

--CAU I.9 DUNG RANG BUOC CHECK CHO THUOC TINH SL
ALTER TABLE CTHD ADD
CONSTRAINT CK_CTHD CHECK (SL >= 1)

--CAU I.10 DUNG RANG BUOC CHECK CHO THUOC TINH NGDK
ALTER TABLE KHACHHANG ADD
CONSTRAINT CK_KH CHECK (NGDK > NGSINH)





---BAI TAP 02---
--CAU I.1
CREATE DATABASE QuanLyGiaoVu
GO 
USE QuanLyGiaoVu

--TAO BANG HOCVIEN

CREATE TABLE HOCVIEN
(
	MAHV char(5) NOT NULL,
	HO varchar(40),
	TEN varchar(10),
	NGSINH smalldatetime,
	GIOITINH varchar(3),
	NOISINH varchar(40),
	MALOP varchar(3)
)

--TAO BANG LOP
CREATE TABLE LOP
(
	MALOP varchar(3) NOT NULL,
	TENLOP varchar(40),
	TRGLOP varchar(5),
	SISO tinyint,
	MAGVCN varchar(4)
)

--TAO BANG KHOA
CREATE TABLE KHOA
(
	MAKHOA varchar(4) NOT NULL,
	TENKHOA varchar(40),
	NGTLAP smalldatetime,
	TRGKHOA varchar(4)
)

--TAO BANG MONHOC
CREATE TABLE MONHOC
(
	MAMH varchar(10) NOT NULL,
	TENMH varchar(40),
	TCLT tinyint,
	TCTH tinyint,
	MAKHOA varchar(4)
)

--TAO BANG DIEUKIEN

CREATE TABLE DIEUKIEN
(
	MAMH varchar(10) NOT NULL,
	MAMH_TRUOC varchar(10) NOT NULL
)

--TAO BANG GIAOVIEN
CREATE TABLE GIAOVIEN
(
	MAGV varchar(4) NOT NULL,
	HOTEN varchar(40),
	HOCVI varchar(10),
	HOCHAM varchar(10),
	GIOITINH varchar(3),
	NGSINH smalldatetime,
	NGVL smalldatetime,
	HESO numeric(4,2),
	MUCLUONG money,
	MAKHOA varchar(4)
)

--TAO BANG GIANGDAY
CREATE TABLE GIANGDAY
(
	MALOP varchar(3) NOT NULL,
	MAMH varchar(10) NOT NULL,
	MAGV varchar(4),
	HOCKI tinyint,
	NAM smallint,
	TUNGAY smalldatetime,
	DENNGAY smalldatetime
)

--TAO BANG KETQUATHI
CREATE TABLE KETQUATHI
(
	MAHV char(5) NOT NULL,
	MAMH varchar(10) NOT NULL,
	LANTHI tinyint NOT NULL,
	NGTHI smalldatetime,
	DIEM numeric(4,2),
	KQUA varchar(10)
)
--XOA RBTV TRUOC KHI XOA BANG GIAOVIEN VA BANG KHOA
ALTER TABLE KHOA 
DROP CONSTRAINT FK_KHOA_TK
DROP TABLE KHOA
DROP TABLE GIAOVIEN

--XOA BANG

DROP TABLE HOCVIEN
DROP TABLE LOP

DROP TABLE MONHOC
DROP TABLE DIEUKIEN

DROP TABLE GIANGDAY
DROP TABLE KETQUATHI

--TAO KHOA CHINH

ALTER TABLE HOCVIEN ADD
CONSTRAINT PK_HV PRIMARY KEY (MAHV)

ALTER TABLE LOP ADD
CONSTRAINT PK_LOP PRIMARY KEY (MALOP)

ALTER TABLE KHOA ADD
CONSTRAINT PK_KHOA PRIMARY KEY (MAKHOA)

ALTER TABLE MONHOC ADD
CONSTRAINT PK_MH PRIMARY KEY (MAMH)

ALTER TABLE DIEUKIEN ADD
CONSTRAINT PK_DK PRIMARY KEY (MAMH,MAMH_TRUOC)

ALTER TABLE GIAOVIEN ADD
CONSTRAINT PK_GV PRIMARY KEY (MAGV)

ALTER TABLE GIANGDAY ADD
CONSTRAINT PK_GD PRIMARY KEY (MALOP,MAMH)

ALTER TABLE KETQUATHI ADD
CONSTRAINT PK_KQT PRIMARY KEY (MAHV,MAMH,LANTHI)

--TAO KHOA NGOAI

USE QuanLyGiaoVu

ALTER TABLE HOCVIEN ADD
CONSTRAINT FK_HV_ML FOREIGN KEY (MALOP) REFERENCES LOP(MALOP)

ALTER TABLE MONHOC ADD
CONSTRAINT FK_MH_MK FOREIGN KEY (MAKHOA) REFERENCES KHOA(MAKHOA)

ALTER TABLE	GIAOVIEN ADD
CONSTRAINT FK_GV_MK FOREIGN KEY (MAKHOA) REFERENCES KHOA(MAKHOA)

ALTER TABLE	GIANGDAY ADD
CONSTRAINT FK_GD_MGV FOREIGN KEY (MAGV) REFERENCES GIAOVIEN(MAGV)

ALTER TABLE KHOA ADD
CONSTRAINT FK_KHOA_TK FOREIGN KEY (TRGKHOA) REFERENCES GIAOVIEN(MAGV)
-- THEM THUOC TINH VAO BANG HOCVIEN

ALTER TABLE HOCVIEN ADD
	GHICHU nvarchar(200),
	DIEMTB numeric(4,2),
	XEPLOAI varchar(20)

--CAU I.2


--CAU I.3 DUNG RANG BUOC CHECK CHO THUOC TINH GIOITINH
ALTER TABLE HOCVIEN ADD
CONSTRAINT CK_GT CHECK (GIOITINH IN ('Nam','Nu'))

--CAU I.4
ALTER TABLE KETQUATHI ADD
CONSTRAINT CK_DIEM CHECK (DIEM >= 0 AND DIEM <= 10)

--CAU I.5
ALTER TABLE KETQUATHI ADD
CONSTRAINT CK_KQ CHECK ((KQUA = 'Dat' AND DIEM >= 5 AND DIEM <= 10) OR (KQUA = 'Khong dat' AND DIEM < 5))

--CAU I.6
ALTER TABLE KETQUATHI ADD
CONSTRAINT CK_LT CHECK (LANTHI >= 0 AND LANTHI <= 3)

--CAU I.7
ALTER TABLE GIANGDAY ADD
CONSTRAINT CK_HK CHECK (HOCKI >= 1 AND HOCKI <= 3)

--CAU I.8
ALTER TABLE GIAOVIEN ADD
CONSTRAINT CK_HV CHECK (HOCVI IN('CN','KS','Ths','TS','PTS'))


--XOA RBTV CHECK
ALTER TABLE GIAOVIEN 
DROP CONSTRAINT CK_HV
ALTER TABLE HOCVIEN 
DROP CONSTRAINT CK_GT




--TUAN 02--



--BAI TAP 01 

--CAU II.1

--NHAP DATA VAO TABLE NHANVIEN

--INSERT INTO NHANVIEN(MANV,HOTEN,NGVL,SODT) VALUES('NV01','Nguyen Nhu Nhut','13-4-2006','0927345678')
INSERT INTO NHANVIEN VALUES('NV01','Nguyen Nhu Nhut','0927345678','13/4/2006')
INSERT INTO NHANVIEN VALUES('NV02','Le Thi Phi Yen','0987567390','21/4/2006')
INSERT INTO NHANVIEN VALUES('NV03','Nguyen Van B','0997047382','27/4/2006')
INSERT INTO NHANVIEN VALUES('NV04','Ngo Thanh Tuan','0913758498','24/6/2006')
INSERT INTO NHANVIEN VALUES('NV05','Nguyen Thi Truc Thanh','0918590387','20/7/2006')

SELECT *FROM NHANVIEN

--NHAP DATA VAO TABLE KHACHHANG
INSERT INTO KHACHHANG VALUES('KH01','Nguyen Van A','731, Tran Hung Dao, Q5, TpHCM','08823451','22/10/1960','22/07/2006',13060000,'Vip')
INSERT INTO KHACHHANG VALUES('KH02','Tran Ngoc Han','23/5, Nguyen Trai, Q5, TpHCM','0908256478','3/4/1974','30/07/2006',280000,'Vang Lai')
INSERT INTO KHACHHANG VALUES('KH03','Tran Ngoc Linh','45, Nguyen Canh Chan, Q1, TpHCM','0938776266','12/6/1980','05/08/2006',38600000,'Vip')
INSERT INTO KHACHHANG VALUES('KH04','Tran Minh Long','50/34, Le Dai Hanh, Q10, TpHCM','0917325476','9/3/1965','02/10/2006',250000 ,'Thuong Xuyen')
INSERT INTO KHACHHANG VALUES('KH05','Le Nhat Minh','34, Truong Dinh, Q3, TpHCM','08246108','10/3/1950','28/10/2006',21000,'Vang Lai')
INSERT INTO KHACHHANG VALUES('KH06','Le Hoai Thuong','227, Nguyen Van Cu, Q5, TpHCM','08631738','31/12/1981','24/11/2006',915000,'Thuong Xuyen')
INSERT INTO KHACHHANG VALUES('KH07','Nguyen Van Tam','32/3, Tran Binh Trong, Q5, TpHCM','0916783565','6/4/1971','01/12/2006',12500,'Vang Lai')
INSERT INTO KHACHHANG VALUES('KH08','Phan Thi Thanh','45/2, An Duong Vuong, Q5, TpHCM','0938435756','10/1/1971','13/12/2006',365000,'Thuong Xuyen')
INSERT INTO KHACHHANG VALUES('KH09','Le Ha Vinh','873, Le Hong Phong, Q5, TpHCM','08654763',' 3/9/1979','14/01/2007',70000,'Vang Lai')
INSERT INTO KHACHHANG VALUES('KH10','Ha Duy Lap','34/34B, Nguyen Trai, Q1, TpHCM','08768904','2/5/1983','16/01/2007', 67500,'Vang Lai')

SELECT *FROM KHACHHANG

--NHAP DATA VAO TABLE SANPHAM
INSERT INTO SANPHAM VALUES('BC01','But Chi','Cay','Singapore',3000)
INSERT INTO SANPHAM VALUES('BC02','But Chi','Cay','Singapore',5000)
INSERT INTO SANPHAM VALUES('BC03','But Chi','Cay','Viet Nam',3500)
INSERT INTO SANPHAM VALUES('BC04','But Chi','Hop','Viet Nam',30000)
INSERT INTO SANPHAM VALUES('BB01','But bi','Cay','Viet Nam',5000)
INSERT INTO SANPHAM VALUES('BB02','But bi','Cay','Trung Quoc',7000)
INSERT INTO SANPHAM VALUES('BB03','But bi','Hop','Thai Lan',100000)
INSERT INTO SANPHAM VALUES('TV01','Tap 100 giay mong','Quyen','Trung Quoc',2500)
INSERT INTO SANPHAM VALUES('TV02','Tap 200 giay mong','Quyen','Trung Quoc',4500)
INSERT INTO SANPHAM VALUES('TV03','Tap 100 giay tot','Quyen','Viet Nam',3000)
INSERT INTO SANPHAM VALUES('TV04','Tap 200 giay tot','Quyen','Viet Nam',5500)
INSERT INTO SANPHAM VALUES('TV05','Tap 100 trang','Chuc','Viet Nam',23000)
INSERT INTO SANPHAM VALUES('TV06','Tap 200 trang','Chuc','Viet Nam',53000)
INSERT INTO SANPHAM VALUES('TV07','Tap 100 trang','Chuc','Trung Quoc',34000)
INSERT INTO SANPHAM VALUES('ST01','So tay 500 trang','Quyen','Trung Quoc',40000)
INSERT INTO SANPHAM VALUES('ST02','So tay loai 1','Quyen','Viet Nam',55000)
INSERT INTO SANPHAM VALUES('ST03','So tay loai 2','Quyen','Viet Nam',51000)
INSERT INTO SANPHAM VALUES('ST04','So tay','Quyen','Thai Lan',55000)
INSERT INTO SANPHAM VALUES('ST05','So tay mong','Quyen','Thai Lan',20000)
INSERT INTO SANPHAM VALUES('ST06','Phan viet bang','Hop','Viet Nam',5000)
INSERT INTO SANPHAM VALUES('ST07','Phan khong bui','Hop','Viet Nam',7000)
INSERT INTO SANPHAM VALUES('ST08','Bong bang','Cai','Viet Nam',1000)
INSERT INTO SANPHAM VALUES('ST09','But long','Cay','Viet Nam',5000) 
INSERT INTO SANPHAM VALUES('ST10','But long','Cay','Trung Quoc',7000)

SELECT *FROM SANPHAM

--NHAP DATA VAO TABLE HOADON
INSERT INTO HOADON VALUES('1001','23/07/2006','KH01','NV01','320000')
INSERT INTO HOADON VALUES('1002','12/08/2006','KH01','NV02','840000')
INSERT INTO HOADON VALUES('1003','23/08/2006','KH02','NV01','100000')
INSERT INTO HOADON VALUES('1004','01/09/2006','KH02','NV01','180000')
INSERT INTO HOADON VALUES('1005','20/10/2006','KH01','NV02','3800000')
INSERT INTO HOADON VALUES('1006','16/10/2006','KH01','NV03','2430000')
INSERT INTO HOADON VALUES('1007','28/10/2006','KH03','NV03','510000')
INSERT INTO HOADON VALUES('1008','28/10/2006','KH01','NV03','440000')
INSERT INTO HOADON VALUES('1009','28/10/2006','KH03','NV04','200000')
INSERT INTO HOADON VALUES('1010','01/11/2006','KH01','NV01','5200000')
INSERT INTO HOADON VALUES('1011','04/11/2006','KH04','NV03','250000')
INSERT INTO HOADON VALUES('1012','30/11/2006','KH05','NV03','21000')
INSERT INTO HOADON VALUES('1013','12/12/2006','KH06','NV01','5000')
INSERT INTO HOADON VALUES('1014','31/12/2006','KH03','NV02','3150000')
INSERT INTO HOADON VALUES('1015','01/01/2007','KH06','NV01','910000')
INSERT INTO HOADON VALUES('1016','01/01/2007','KH07','NV02','12500')
INSERT INTO HOADON VALUES('1017','02/01/2007','KH08','NV03','35000')
INSERT INTO HOADON VALUES('1018','13/01/2007','KH08','NV03','330000')
INSERT INTO HOADON VALUES('1019','13/01/2007','KH01','NV03','30000')
INSERT INTO HOADON VALUES('1020','14/01/2007','KH09','NV04','70000')
INSERT INTO HOADON VALUES('1021','16/01/2007','KH10','NV03','67500')
INSERT INTO HOADON VALUES('1022','16/01/2007',Null,'NV03','7000')
INSERT INTO HOADON VALUES('1023','17/01/2007',Null,'NV01','330000')

SELECT *FROM HOADON

--NHAP DATA VAO TABLE CTHD
INSERT INTO CTHD VALUES (1001,'TV02',10)
INSERT INTO CTHD VALUES (1001,'ST01',5)
INSERT INTO CTHD VALUES (1001,'BC01',5)
INSERT INTO CTHD VALUES (1001,'BC02',10)
INSERT INTO CTHD VALUES (1001,'ST08',10)
INSERT INTO CTHD VALUES (1002,'BC04',20)
INSERT INTO CTHD VALUES (1002,'BB01',20)
INSERT INTO CTHD VALUES (1002,'BB02',20)
INSERT INTO CTHD VALUES (1003,'BB03',10)
INSERT INTO CTHD VALUES (1004,'TV01',20)
INSERT INTO CTHD VALUES (1004,'TV02',10)
INSERT INTO CTHD VALUES (1004,'TV03',10)
INSERT INTO CTHD VALUES (1004,'TV04',10)
INSERT INTO CTHD VALUES (1005,'TV05',50)
INSERT INTO CTHD VALUES (1005,'TV06',50)
INSERT INTO CTHD VALUES (1006,'TV07',20)
INSERT INTO CTHD VALUES (1006,'ST01',30)
INSERT INTO CTHD VALUES (1006,'ST02',10)
INSERT INTO CTHD VALUES (1007,'ST03',10)
INSERT INTO CTHD VALUES (1008,'ST04',8)
INSERT INTO CTHD VALUES (1009,'ST05',10)
INSERT INTO CTHD VALUES (1010,'TV07',50)
INSERT INTO CTHD VALUES (1010,'ST07',50)
INSERT INTO CTHD VALUES (1010,'ST08',100)
INSERT INTO CTHD VALUES (1010,'ST04',50)
INSERT INTO CTHD VALUES (1010,'TV03',100)
INSERT INTO CTHD VALUES (1011,'ST06',50)
INSERT INTO CTHD VALUES (1012,'ST07',3)
INSERT INTO CTHD VALUES (1013,'ST08',5)
INSERT INTO CTHD VALUES (1014,'BC02',80)
INSERT INTO CTHD VALUES (1014,'BB02',100)
INSERT INTO CTHD VALUES (1014,'BC04',60)
INSERT INTO CTHD VALUES (1014,'BB01',50)
INSERT INTO CTHD VALUES (1015,'BB02',30)
INSERT INTO CTHD VALUES (1015,'BB03',7)
INSERT INTO CTHD VALUES (1016,'TV01',5)
INSERT INTO CTHD VALUES (1017,'TV02',1)
INSERT INTO CTHD VALUES (1017,'TV03',1)
INSERT INTO CTHD VALUES (1017,'TV04',5)
INSERT INTO CTHD VALUES (1018,'ST04',6)
INSERT INTO CTHD VALUES (1019,'ST05',1)
INSERT INTO CTHD VALUES (1019,'ST06',2)
INSERT INTO CTHD VALUES (1020,'ST07',10)
INSERT INTO CTHD VALUES (1021,'ST08',5)
INSERT INTO CTHD VALUES (1021,'TV01',7)
INSERT INTO CTHD VALUES (1021,'TV02',10)
INSERT INTO CTHD VALUES (1022,'ST07',1)
INSERT INTO CTHD VALUES (1023,'ST04',6)

SELECT *FROM CTHD 


--BAI TAP 02


--NHAP DU LIEU CHO CSDL QuanLyGiaoVu

--XOA KHOA NGOAI TRUOC KHI INSERT DATA 
ALTER TABLE GIAOVIEN DROP CONSTRAINT FK_GV_MK
ALTER TABLE GIANGDAY DROP CONSTRAINT FK_GD_MGV
ALTER TABLE KHOA DROP CONSTRAINT FK_KHOA_TK
--SAU KHI INSERT XONG PHARI TAO LAI CAC KHOA NGOAI

--NHAP DATA CHO TABLE KHOA

INSERT INTO KHOA VALUES ('KHMT','Khoa hoc may tinh','7/6/2005','GV01')
INSERT INTO KHOA VALUES ('HTTT','He thong thong tin','7/6/2005','GV02')
INSERT INTO KHOA VALUES ('CNPM','Cong nghe phan mem','7/6/2005','GV04')
INSERT INTO KHOA VALUES ('MTT','Mang va truyen thong','20/10/2005','GV03')
INSERT INTO KHOA VALUES ('KTMT','Ky thuat may tinh','20/12/2005',Null)

SELECT *FROM KHOA

--NHAP DATA CHO TABLE KHOA
INSERT INTO LOP VALUES ('K11','Lop 1 khoa 1','K1108',11,'GV07')
INSERT INTO LOP VALUES ('K12','Lop 2 khoa 1','K1205',12,'GV09')
INSERT INTO LOP VALUES ('K13','Lop 3 khoa 1','K1305',12,'GV14')

SELECT *FROM LOP

--NHAP DATA CHO TABLE MONHOC
INSERT INTO MONHOC VALUES ('THDC','Tin hoc dai cuong',4,1,'KHMT')
INSERT INTO MONHOC VALUES ('CTRR','Cau truc roi rac',5,0,'KHMT')
INSERT INTO MONHOC VALUES ('CSDL','Co so du lieu',3,1,'HTTT')
INSERT INTO MONHOC VALUES ('CTDLGT','Cau truc du lieu va giai thuat',3,1,'KHMT')
INSERT INTO MONHOC VALUES ('PTTKTT','Phan tich thiet ke thuat toan',3,0,'KHMT')
INSERT INTO MONHOC VALUES ('DHMT','Do hoa may tinh',3,1,'KHMT')
INSERT INTO MONHOC VALUES ('KTMT','Kien truc may tinh',3,0,'KTMT')
INSERT INTO MONHOC VALUES ('TKCSDL','Thiet ke co so du lieu',3,1,'HTTT')
INSERT INTO MONHOC VALUES ('PTTKHTTT','Phan tich thiet ke he thong thong tin',4,1,'HTTT')
INSERT INTO MONHOC VALUES ('HDH','He dieu hanh',4,0,'KTMT')
INSERT INTO MONHOC VALUES ('NMCNPM','Nhap mon cong nghe phan mem',3,0,'CNPM')
INSERT INTO MONHOC VALUES ('LTCFW','Lap trinh C for win',3,1,'CNPM')
INSERT INTO MONHOC VALUES ('LTHDT','Lap trinh huong doi tuong',3,1,'CNPM')

SELECT *FROM MONHOC

--NHAP DATA CHO TABLE GIANGDAY
INSERT INTO GIANGDAY VALUES ('K11','THDC','GV07',1,2006,'2/1/2006','12/5/2006')
INSERT INTO GIANGDAY VALUES ('K12','THDC','GV06', 1,2006,'2/1/2006','12/5/2006')
INSERT INTO GIANGDAY VALUES ('K13','THDC','GV15',1,2006,'2/1/2006','12/5/2006')
INSERT INTO GIANGDAY VALUES ('K11','CTRR','GV02',1,2006,'9/1/2006','17/5/2006')
INSERT INTO GIANGDAY VALUES ('K12','CTRR','GV02',1,2006,'9/1/2006','17/5/2006')
INSERT INTO GIANGDAY VALUES ('K13','CTRR','GV08',1,2006,'9/1/2006','17/5/2006')
INSERT INTO GIANGDAY VALUES ('K11','CSDL','GV05',2,2006,'1/6/2006','15/7/2006')
INSERT INTO GIANGDAY VALUES ('K12','CSDL','GV09',2,2006,'1/6/2006','15/7/2006')
INSERT INTO GIANGDAY VALUES ('K13','CTDLGT','GV15',2,2006,'1/6/2006','15/7/2006')
INSERT INTO GIANGDAY VALUES ('K13','CSDL','GV05',3,2006,'1/8/2006','15/12/2006')
INSERT INTO GIANGDAY VALUES ('K13','DHMT','GV07',3,2006,'1/8/2006','15/12/2006')
INSERT INTO GIANGDAY VALUES ('K11','CTDLGT','GV15',3,2006,'1/8/2006','15/12/2006')
INSERT INTO GIANGDAY VALUES ('K12','CTDLGT','GV15',3,2006,'1/8/2006','15/12/2006')
INSERT INTO GIANGDAY VALUES ('K11','HDH','GV04',1,2007,'2/1/2007','18/2/2007')
INSERT INTO GIANGDAY VALUES ('K12','HDH','GV04',1,2007,'2/1/2007','20/3/2007')
INSERT INTO GIANGDAY VALUES ('K11','DHMT','GV07',1,2007,'18/2/2007','20/3/2007')

SELECT *FROM GIANGDAY

--NHAP DATA CHO TABLE GIAOVIEN
INSERT INTO GIAOVIEN VALUES ('GV01','Ho Thanh Son','PTS','GS','Nam','2/5/1950','11/1/2004',5.00, 2250000,'KHMT')
INSERT INTO GIAOVIEN VALUES ('GV02','Tran Tam Thanh','TS','PGS','Nam','17/12/1965','20/4/2004',4.50,2025000,'HTTT')
INSERT INTO GIAOVIEN VALUES ('GV03','Do Nghiem Phung','TS','GS','Nu','1/8/1950','23/9/2004',4.00,1800000,'CNPM')
INSERT INTO GIAOVIEN VALUES ('GV04','Tran Nam Son','TS','PGS','Nam','22/2/1961','12/1/2005',4.50,2025000,'KTMT')
INSERT INTO GIAOVIEN VALUES ('GV05','Mai Thanh Danh','ThS','GV','Nam','12/3/1958','12/1/2005',3.00,1350000,'HTTT')
INSERT INTO GIAOVIEN VALUES ('GV06','Tran Doan Hung','TS','GV','Nam','11/3/1953','12/1/2005',4.50,2025000,'KHMT')
INSERT INTO GIAOVIEN VALUES ('GV07','Nguyen Minh Tien','ThS','GV','Nam','23/11/1971','1/3/2005',4.00,1800000,'KHMT')
INSERT INTO GIAOVIEN VALUES ('GV08','Le Thi Tran','KS',Null,'Nu','26/3/1974','1/3/2005',1.69,760500,'KHMT')
INSERT INTO GIAOVIEN VALUES ('GV09','Nguyen To Lan','ThS','GV','Nu','31/12/1966','1/3/2005',4.00,1800000,'HTTT')
INSERT INTO GIAOVIEN VALUES ('GV10','Le Tran Anh Loan','KS',Null,'Nu','17/7/1972','1/3/2005',1.86,837000,'CNPM')
INSERT INTO GIAOVIEN VALUES ('GV11','Ho Thanh Tung','CN','GV','Nam','12/1/1980','15/5/2005',2.67,1201500,'MTT')
INSERT INTO GIAOVIEN VALUES ('GV12','Tran Van Anh','CN',Null,'Nu','29/3/1981','15/5/2005',1.69,760500,'CNPM')
INSERT INTO GIAOVIEN VALUES ('GV13','Nguyen Linh Dan','CN',Null,'Nu','23/5/1980','15/5/2005',1.69,760500,'KTMT')
INSERT INTO GIAOVIEN VALUES ('GV14','Truong Minh Chau','ThS','GV','Nu','30/11/1976','15/5/2005',3.00,1350000,'MTT')
INSERT INTO GIAOVIEN VALUES ('GV15','Le Ha Thanh','ThS','GV','Nam','4/5/1978','15/5/2005',3.00,1350000,'KHMT')

SELECT *FROM GIAOVIEN

--NHAP DATA CHO TABLE DIEUKIEN

INSERT INTO DIEUKIEN VALUES ('CSDL','CTRR')
INSERT INTO DIEUKIEN VALUES ('CSDL','CTDLGT')
INSERT INTO DIEUKIEN VALUES ('CTDLGT','THDC')
INSERT INTO DIEUKIEN VALUES ('PTTKTT','THDC')
INSERT INTO DIEUKIEN VALUES ('PTTKTT','CTDLGT')
INSERT INTO DIEUKIEN VALUES ('DHMT','THDC')
INSERT INTO DIEUKIEN VALUES ('LTHDT',' HDC')
INSERT INTO DIEUKIEN VALUES ('PTTKHTTT','CSDL')

SELECT *FROM DIEUKIEN

--NHAP DATA CHO TABLE KETQUATHI

INSERT INTO KETQUATHI VALUES ('K1101','CSDL',1,'20/7/2006',10.00,'Dat')
INSERT INTO KETQUATHI VALUES ('K1101','CTDLGT',1,'28/12/2006',9.00,'Dat')
INSERT INTO KETQUATHI VALUES ('K1101','THDC',1,'20/5/2006',9.00,'Dat')
INSERT INTO KETQUATHI VALUES ('K1101','CTRR',1,'13/5/2006',9.50,'Dat')
INSERT INTO KETQUATHI VALUES ('K1102','CSDL',1,'20/7/2006',4.00,'Khong Dat')
INSERT INTO KETQUATHI VALUES ('K1102','CSDL',2,'27/7/2006',4.25,'Khong Dat')
INSERT INTO KETQUATHI VALUES ('K1102','CSDL',3,'10/8/2006',4.50,'Khong Dat')
INSERT INTO KETQUATHI VALUES ('K1102','CTDLGT',1,'28/12/2006',4.50,'Khong Dat')
INSERT INTO KETQUATHI VALUES ('K1102','CTDLGT',2,'5/1/2007',4.00,'Khong Dat')
INSERT INTO KETQUATHI VALUES ('K1102','CTDLGT',3,'15/1/2007',6.00,'Dat')
INSERT INTO KETQUATHI VALUES ('K1102','THDC',1,'20/5/2006',5.00,'Dat')
INSERT INTO KETQUATHI VALUES ('K1102','CTRR',1,'13/5/2006',7.00,'Dat')
INSERT INTO KETQUATHI VALUES ('K1103','CSDL',1,'20/7/2006',3.50,'Khong Dat')
INSERT INTO KETQUATHI VALUES ('K1103','CSDL',2,'27/7/2006',8.25,'Dat')
INSERT INTO KETQUATHI VALUES ('K1103','CTDLGT',1,'28/12/2006',7.00,'Dat')
INSERT INTO KETQUATHI VALUES ('K1103','THDC',1,'20/5/2006',8.00,'Dat')
INSERT INTO KETQUATHI VALUES ('K1103','CTRR',1,'13/5/2006',6.50,'Dat')
INSERT INTO KETQUATHI VALUES ('K1104','CSDL',1,'20/7/2006',3.75,'Dat')
INSERT INTO KETQUATHI VALUES ('K1104','CTDLGT',1,'28/12/2006',4.00,'Khong Dat')
INSERT INTO KETQUATHI VALUES ('K1104','THDC',1,'20/5/2006',4.00,'Khong Dat')
INSERT INTO KETQUATHI VALUES ('K1104','CTRR',1,'13/5/2006',4.00,'Khong Dat')
INSERT INTO KETQUATHI VALUES ('K1104','CTRR',2,'20/5/2006',3.50,'Khong Dat')
INSERT INTO KETQUATHI VALUES ('K1104','CTRR',3,'30/6/2006',4.00,'Khong Dat')
INSERT INTO KETQUATHI VALUES ('K1201','CSDL',1,'20/7/2006',6.00,'Dat')
INSERT INTO KETQUATHI VALUES ('K1201','CTDLGT',1,'28/12/2006',5.00,'Dat')
INSERT INTO KETQUATHI VALUES ('K1201','THDC',1,'20/5/2006',8.50,'Dat')
INSERT INTO KETQUATHI VALUES ('K1201','CTRR',1,'13/5/2006',9.00,'Dat')
INSERT INTO KETQUATHI VALUES ('K1202','CSDL',1,'20/7/2006',8.00,'Dat')
INSERT INTO KETQUATHI VALUES ('K1202','CTDLGT',1,'28/12/2006',4.00,'Khong Dat')
INSERT INTO KETQUATHI VALUES ('K1202','CTDLGT',2,'5/1/2007',5.00,'Dat')
INSERT INTO KETQUATHI VALUES ('K1202','THDC',1,'20/5/2006', 4.00,'Khong Dat')
INSERT INTO KETQUATHI VALUES ('K1202','THDC',2,'27/5/2006',4.00,'Khong Dat')
INSERT INTO KETQUATHI VALUES ('K1202','CTRR',1,'13/5/2006',3.00,'Khong Dat')
INSERT INTO KETQUATHI VALUES ('K1202','CTRR',2,'20/5/2006',4.00,'Khong Dat')
INSERT INTO KETQUATHI VALUES ('K1202','CTRR',3,'30/6/2006',6.25,'Dat')
INSERT INTO KETQUATHI VALUES ('K1203','CSDL',1,'20/7/2006',9.25,'Dat')
INSERT INTO KETQUATHI VALUES ('K1203','CTDLGT',1,'28/12/2006',9.50,'Dat')
INSERT INTO KETQUATHI VALUES ('K1203','THDC',1,'20/5/2006',10.00,'Dat')
INSERT INTO KETQUATHI VALUES ('K1203','CTRR',1,'13/5/2006',10.00,'Dat')
INSERT INTO KETQUATHI VALUES ('K1204','CSDL',1,'20/7/2006',8.50,'Dat')
INSERT INTO KETQUATHI VALUES ('K1204','CTDLGT',1,'28/12/2006',6.75,'Dat')
INSERT INTO KETQUATHI VALUES ('K1204','THDC',1,'20/5/2006',4.00,'Khong Dat')
INSERT INTO KETQUATHI VALUES ('K1204','CTRR',1,'13/5/2006',6.00,'Dat')
INSERT INTO KETQUATHI VALUES ('K1301','CSDL',1,'20/12/2006',4.25,'Khong Dat')
INSERT INTO KETQUATHI VALUES ('K1301','CTDLGT',1,'25/7/2006',8.00,'Dat')
INSERT INTO KETQUATHI VALUES ('K1301','THDC',1,'20/5/2006',7.75,'Dat')
INSERT INTO KETQUATHI VALUES ('K1301','CTRR',1,'13/5/2006',8.00,'Dat')
INSERT INTO KETQUATHI VALUES ('K1302','CSDL',1,'20/12/2006',6.75,'Dat')
INSERT INTO KETQUATHI VALUES ('K1302','CTDLGT',1,'25/7/2006',5.00,'Dat')
INSERT INTO KETQUATHI VALUES ('K1302','THDC',1,'20/5/2006',8.00,'Dat')
INSERT INTO KETQUATHI VALUES ('K1302','CTRR',1,'13/5/2006',8.50,'Dat')
INSERT INTO KETQUATHI VALUES ('K1303','CSDL',1,'20/12/2006',4.00,'Khong Dat')
INSERT INTO KETQUATHI VALUES ('K1303','CTDLGT',1,'25/7/2006',4.50,'Khong Dat')
INSERT INTO KETQUATHI VALUES ('K1303','CTDLGT',2,'7/8/2006',4.00,'Khong Dat')
INSERT INTO KETQUATHI VALUES ('K1303','CTDLGT',3,'15/8/2006',4.25,'Khong Dat')
INSERT INTO KETQUATHI VALUES ('K1303','THDC',1,'20/5/2006',4.50,'Khong Dat')
INSERT INTO KETQUATHI VALUES ('K1303','CTRR',1,'13/5/2006',3.25,'Khong Dat')
INSERT INTO KETQUATHI VALUES ('K1303','CTRR',2,'20/5/2006',5.00,'Dat')
INSERT INTO KETQUATHI VALUES ('K1304','CSDL',1,'20/12/2006',7.75,'Dat')
INSERT INTO KETQUATHI VALUES ('K1304','CTDLGT',1,'25/7/2006',9.75,'Dat')
INSERT INTO KETQUATHI VALUES ('K1304','THDC',1,'20/5/2006',5.50,'Dat')
INSERT INTO KETQUATHI VALUES ('K1304','CTRR',1,'13/5/2006',5.00,' Dat')
INSERT INTO KETQUATHI VALUES ('K1305','CSDL',1,'20/12/2006',9.25,'Dat')
INSERT INTO KETQUATHI VALUES ('K1305','CTDLGT',1,'25/7/2006',10.00,'Dat')
INSERT INTO KETQUATHI VALUES ('K1305','THDC',1,'20/5/2006',8.00,'Dat')
INSERT INTO KETQUATHI VALUES ('K1305','CTRR',1,'13/5/2006',10.00,'Dat')

SELECT *FROM KETQUATHI

--NHAP DATA CHO TABLE HOCVIEN
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1101','Nguyen Van','A','27/1/1986','Nam','TpHCM','K11')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1102','Tran Ngoc','Han','14/3/1986','Nu','Kien Giang','K11')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1103','Ha Duy','Lap','18/4/1986','Nam','Nghe An','K11')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1104','Tran Ngoc','Linh','30/3/1986','Nu','Tay Ninh','K11')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1105','Tran Minh','Long','27/2/1986','Nam','TpHCM','K11')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1106','Le Nhat','Minh','24/1/1986','Nam','TpHCM','K11')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1107','Nguyen Nhu','Nhut','27/1/1986','Nam','Ha Noi','K11')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1108','Nguyen Manh','Tam','27/2/1986','Nam','Kien Giang','K11')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1109','Phan Thi Thanh','Tam','27/1/1986','Nu','Vinh Long','K11')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1110','Le Hoai','Thuong','5/2/1986','Nu','Can Tho','K11')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1111','Le Ha','Vinh','25/12/1986','Nam','Vinh Long','K11')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1201','Nguyen Van','B','11/2/1986','Nam','TpHCM','K12')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1202','Nguyen Thi Kim','Duyen','18/1/1986','Nu','TpHCM','K12')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1203','Tran Thi Kim','Duyen','17/9/1986','Nu','TpHCM','K12')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1204','Truong My','Hanh','19/5/1986','Nu','Dong Nai','K12')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1205','Nguyen Thanh','Nam','17/4/1986','Nam','TpHCM','K12')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1206','Nguyen Thi Truc','Thanh','4/3/1986',' Nu','Kien Giang','K12')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1207','Tran Thi Bich','Thuy','8/2/1986','Nu','Nghe An','K12')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1208','Huynh Thi Kim','Trieu','8/4/1986','Nu','Tay Ninh','K12')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1209','Pham Thanh','Trieu','23/2/1986','Nam','TpHCM','K12')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1210','Ngo Thanh','Tuan','14/2/1986','Nam','TpHCM','K12')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1211','Do Thi','Xuan','9/3/1986','Nu','Ha Noi','K12')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1212','Le Thi Phi','Yen','12/3/1986','Nu','TpHCM','K12')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1301','Nguyen Thi Kim','Cuc','9/6/1986','Nu','Kien Giang','K13')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1302','Truong Thi My','Hien','18/3/1986','Nu','Nghe An','K13')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1303','Le Duc','Hien','21/3/1986','Nam','Tay Ninh','K13')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1304','Le Quang','Hien','18/4/1986','Nam','TpHCM','K13')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1305','Le Thi','Huong','27/3/1986','Nu','TpHCM','K13')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1306','Nguyen Thai','Huu','30/3/1986','Nam','Ha Noi','K13')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1307','Tran Minh','Man','28/5/1986','Nam','TpHCM','K13')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1308','Nguyen Hieu','Nghia','8/4/1986','Nam','Kien Giang','K13')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1309','Nguyen Trung','Nghia','18/1/1987','Nam','Nghe An','K13')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1310','Tran Thi Hong','Tham','22/4/1986','Nu','Tay Ninh','K13')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1311','Tran Minh','Thuc','4/4/1986','Nam','TpHCM','K13')
INSERT INTO HOCVIEN(MAHV,HO,TEN,NGSINH,GIOITINH,NOISINH,MALOP) VALUES ('K1312','Nguyen Thi Kim','Yen','7/9/1986','Nu','TpHCM','K13')

SELECT *FROM HOCVIEN

--BAI TAP 03

--CAU II.2
--LENH SAO CHEP MOT BANG DU LIEU 

SELECT *INTO SANPHAM1 FROM SANPHAM 
SELECT *INTO KHACHHANG1 FROM KHACHHANG 

--CAU II.3
--LENH UPDATE 

UPDATE SANPHAM1 SET GIA = GIA*1.05
WHERE NUOCSX = 'Thai Lan'

--CAU II.4
--LENH UPDATE 

UPDATE SANPHAM1 SET GIA = GIA*0.95
WHERE NUOCSX = 'Trung Quoc' AND GIA <= 10000

--CAU II.5
--LENH UPDATE

UPDATE KHACHHANG1 SET LOAIKH = 'Vip'
WHERE (NGDK < '1/1/2007' AND DOANHSO >= 10000000) OR (NGDK > '1/1/2007' AND DOANHSO >= 2000000)


--BAI TAP 04
--SU DUNG CAU LENH CHECK CHO CAU I.11 -> I.14

--CAU I.11

ALTER TABLE HOCVIEN ADD
CONSTRAINT CK_TUOI_HV CHECK (YEAR(GETDATE())-YEAR(NGSINH) >= 18)

--CAU I.12

ALTER TABLE GIANGDAY ADD
CONSTRAINT CK_NGAY CHECK (TUNGAY < DENNGAY)

--CAU I.13

ALTER TABLE GIAOVIEN ADD
CONSTRAINT CK_TUOI_GV CHECK (YEAR(GETDATE())-YEAR(NGSINH) >= 22)

--CAU I.14
--XOA DU LIEU TRONG BANG TRUOC KHI TAO RANG BUOC CHECK

DELETE FROM MONHOC 

ALTER TABLE MONHOC ADD
CONSTRAINT CK_TC CHECK (ABS(TCLT-TCTH) <= 3)

--SAU DO CHAY LAI LENH INSERT


